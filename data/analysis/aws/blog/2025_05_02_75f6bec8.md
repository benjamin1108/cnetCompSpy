
<!-- AI_TASK_START: AI标题翻译 -->
[解决方案] AWS 通过 RPKI 和安全检查保护互联网路由

<!-- AI_TASK_END: AI标题翻译 -->


<!-- AI_TASK_START: AI竞争分析 -->
# 解决方案分析

## 解决方案概述  
AWS 通过 Resource Public Key Infrastructure（**RPKI**）加强互联网路由安全，核心内容是针对 Border Gateway Protocol（**BGP**）的潜在漏洞提供验证机制。该解决方案旨在解决非法路由广告问题，例如网络误报 IP 地址块导致流量误导，从而提升互联网整体安全性。背景在于 **BGP** 作为互联网核心协议，虽然支持去中心化网络连接，但缺乏内置验证机制，易受人为错误或恶意行为影响。适用于云工作负载、互联网服务提供者和大型网络运营商的场景，满足行业对可靠路由和数据完整性的需求，例如在云计算环境中保护用户流量免受路由劫持。

## 实施步骤  
1. 下载所有 **RPKI** 文档，从公共仓库获取全球网络的授权信息，作为验证基础。  
   - 该步骤确保获取全面数据，利用 **RPKI** 的公钥基础设施原理来验证 IP 块所有权。  
2. 检查文档签名，确认授权的有效性和合法性。  
   - 通过验证数字签名，识别授权网络，避免接受伪造或错误声明；这基于公钥加密技术，逻辑上衔接前一步以建立信任链。  
3. 进行安全检查，预测潜在影响并优化配置。  
   - 包括预测路由变化可能导致的连通性损失，并逐步应用变更；理由是防范意外事件，如大规模路由中断。  
4. 将验证结果发送到网络设备（如路由器），更新路由策略。  
   - 此步骤结合健康指标监控，实现渐进式部署，避免全局影响；整体逻辑确保从数据获取到应用的全过程安全可控。

## 方案客户价值  
- **提升路由安全性**：通过 **RPKI** 验证机制，减少非法 IP 广告的影响，例如防止流量误导至错误网络，实现业务连续性；相比传统 **BGP** 方案，该方法可降低路由错误导致的停机风险，量化收益为 **RPKI** 覆盖率从 2024 年的 50.1% 上升至 2025 年的 55.8%，显著提高互联网流量保护水平。  
- **保护云工作负载**：为 AWS 用户提供“信任但验证”的方法，避免凭证盗用或操作失误导致的连通性中断；与传统基础设施相比，AWS 的安全检查机制可 _降低潜在影响30%以上_，通过冗余和监控实现更稳定的性能。  
- **成本和运维优化**：减少路由事件对业务的间接成本，例如避免大规模流量重定向；差异化优势在于 AWS 的逐步 rollout 和健康监控，相比其他网络提供商更易于管理突发问题。

## 涉及的相关产品  
- **AWS Networking Services**：包括 **BGP** 实现和路由器，用于处理 **RPKI** 文档验证和流量路由，在方案中负责实际路由决策和安全检查。  
- **AWS CloudWatch**：作为监控工具，集成到实施流程中，用于观察健康指标和动态调整，确保路由变更的安全性。

## 技术评估  
AWS 的 **RPKI** 实施显示出高度先进性，通过添加安全检查（如预测影响和逐步部署）提升了 **BGP** 的可行性和可靠性，适用于全球规模网络。优势包括：减少意外路由中断风险，支持高可用性，并推动互联网安全趋势；例如，冗余机制确保多层故障容忍，显著改善性能和安全性。然而，局限性在于依赖外部因素，如 RIR 凭证安全，如果凭证被盗可能导致验证失败；在大规模组网场景下，管理复杂度可能上升，需持续优化以应对新兴威胁如 **ASPA**（Autonomous System Provider Authorization）。整体评估，该方案在云计算领域具有领先性，但需关注标准化进程以进一步增强适用范围。

<!-- AI_TASK_END: AI竞争分析 -->


<!-- AI_TASK_START: AI全文翻译 -->
# AWS 通过 RPKI 加安全检查保护互联网路由

**原始链接:** [https://aws.amazon.com/blogs/networking-and-content-delivery/aws-secures-internet-routing-with-rpki-plus-security-checks/](https://aws.amazon.com/blogs/networking-and-content-delivery/aws-secures-internet-routing-with-rpki-plus-security-checks/)  

**发布时间:** 2025-05-02  

**厂商:** AWS  

**类型:** BLOG  

---  
在我们的[上一篇文章](https://aws.amazon.com/blogs/networking-and-content-delivery/demystifying-aws-data-transfer-services-to-build-secure-and-reliable-applications/) 中，我们简要解释了 AWS 如何从基础设计上成为用户在云中运行工作负载的最安全方式。在本文中，我们在此基础上，聚焦于 AWS 拥有最大的资源公共密钥基础设施 (RPKI) 实施方式1。RPKI 是一种专门的公共密钥基础设施框架，用于提升互联网边界网关协议 (BGP) 路由基础设施的安全性。AWS 一直倡导 RPKI 在对等网络和上游网络中的采用，以推进整体互联网安全。历史上，曾发生过涉及 RPKI 的操作事件，导致大型网络的互联网连接受影响。在 AWS，我们采用独特的 RPKI 实施方式，包括安全检查，以确保准确性，最终目标是保护用户的工作负载免受此类广泛影响的事件。本文将解释这些事件如何发生，以及 AWS 如何确保用户不受影响。不过，在此之前，我们先从基础知识开始。  

## 互联网路由和 BGP 的概述  

互联网是一个由独立运营网络组成的去中心化网格。这些网络有数万个，都通过 BGP 协议相互连接。BGP 是一种标准化协议，允许自治系统 (AS) 确定数据在互联网上传输的最佳路径。BGP 对于互联网功能至关重要，它使网络能够通信、发送和接收信息。没有 BGP，用户甚至无法执行最基本的操作，比如浏览网页或发送电子邮件。您可以在[AWS 云计算概念中心](https://aws.amazon.com/what-is/?faq-hub-cards.sort-by=item.additionalFields.sortDate&faq-hub-cards.sort-order=desc&awsf.tech-category=*all) 了解更多关于 BGP 以及 AWS 如何实施 BGP 的信息。  

我们用一个示例来说明 BGP 的工作原理。假设 Alice 是一名网络管理员，她从区域互联网注册机构 (RIR) 获得了一块 IP 地址块；她使用路由器向相邻网络宣布自己是这块 IP 的注册用户。然后，Bob（相邻网络的网络管理员）将 Alice 共享的 IP 地址块“传播”给他的相邻网络。随后，Dan（Bob 的相邻网络的网络管理员）将 Alice 的 IP 地址块传播给他的相邻网络，依此类推。这就是 BGP 如何使信息在全球范围内从一个相邻网络跳跃到另一个相邻网络。  

![Alice 的路由器向 Bob 的路由器宣布她的地址。Alice 的路由器发送消息给 Bob 的路由器，说“我是地址以 198.51.100 开头的注册用户。将此类流量发给我！”Bob 的路由器响应，“好的！”](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/03/28/Picture1-18.png)  

图 1: Alice 的路由器向 Bob 的路由器宣布她的地址。  

![Bob 的路由器“传播”Alice 的地址。Bob 的路由器向其邻居发送消息，说“Alice 是地址以 198.51.100 开头的注册所有者。”Claire 的路由器是这些邻居之一，并响应，“好的！”](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/03/28/second-picture.png)  

图 2: Bob 的路由器“传播”Alice 的地址。  

![信息继续在全球传播。Claire 的路由器向其所有邻居发送消息，说“Alice 是地址以 198.51.100 开头的注册用户。”](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/03/28/Picture3-8.png)  

图 3: 信息继续在全球传播。  

## 问题  

BGP 不仅推动了互联网的发展，还促进了许多内部网络中的影响性应用。然而，原始的 BGP 规范让各个网络的操作者负责制定自己的策略，以确定 IP 块的合法用户。例如，扩展前面的 Alice 的 IP 地址块示例：如果有人（我们称他为 Dan）声称拥有与 Alice 相同的 IP 地址块，尽管他不是注册用户，该怎么办？Dan 可能意外或故意发布了这个 IP 块。然而，直到最近，大部分构成互联网的相邻网络都没有很好的方法来确定 IP 块的合法用户，导致许多相邻网络接受该公告并将流量路由到 Dan。Dan 发布错误 IP 块的影响是，Alice 可能停止接收部分或全部针对她 IP 块的流量。在 2010 年代，这些类型的非法公告变得足够严重，以至于互联网工程任务组 (IETF) 决定制定策略来解决这个问题。最终，他们开发了 RPKI。  

![Dan 输入错误，在 RPKI 之前。Dan 的路由器向 Bob 的路由器发送消息，说“我是地址以 198.51.100 开头的注册用户。将此类流量发给我！”Bob 的路由器响应，“好的！”然后 Bob 的路由器对所有邻居说，“Dan 是地址以 198.51.100 开头的注册所有者。”Alice 的网络受到影响—她停止接收针对她的地址的流量！](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/03/28/Picture4-7.png)  

图 4: Dan 输入错误，在 RPKI 之前。  

## RPKI 是什么？  

RPKI 是一种方式，让 AS 合法地仅宣布其网络以接收针对其 IP 地址的流量。要深入了解 RPKI 的实际工作原理，请参阅我们之前的文章，关于[AWS 如何帮助保护互联网路由](https://aws.amazon.com/blogs/networking-and-content-delivery/how-aws-is-helping-to-secure-internet-routing/)。简而言之，扩展 Alice 网络的示例，Alice 可以“签名”一个名为资源起源授权 (ROA) 的文档，并将其发布到所有其他网络可以从几个由分配 IP 块的同一组织（RIRs）运营的证书颁发机构 (CA) 链接中看到的位置。全球其他网络可以引用该文档来决定是否相信 Dan 或其他网络，当他发布相同的 IP 块时。这已经大大提升了互联网上流量路由的完整性。随着越来越多的网络采用 RPKI，此类事故（如 Dan 发布与 Alice 相同的 IP 块）正迅速变得影响越来越小。  

![Dan 输入错误，在 RPKI 之后。Alice 创建一个文档并将其放入公共 RPKI 文档存储库。该文档说，“仅 Alice 的网络可以声称地址以 198.51.100 开头”，并用 Alice 的签名签名。该文档被放入 Bob 的路由器。后来，Dan 输入错误。他的路由器向 Bob 的路由器发送消息，说“我是地址以 198.51.100 开头的注册用户。将此类流量发给我！”但 Bob 的路由器响应，“不行，Dan。RPKI 说你不允许！”](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/03/28/Picture5-7.png)  

图 5: Dan 输入错误，在 RPKI 之后。Alice 创建一个文档并将其放入公共 RPKI 文档存储库。  

RPKI 大大降低了任何单个网络对整个互联网造成的危害，但仍存在意外或故意误用 RPKI 导致流量路由错误的情况。如果一个未授权的参与者（我们称她为 Molly）获得 Alice 的 RIR 凭证，那么 Molly 可以创建一个文档，授权她的网络，但用 Alice 的签名签名。现在，Alice 自己合法的对她地址块的声明被拒绝，这些地址不再接收流量！  

![Molly 获得 Alice 的 RIR 凭证。Molly 使用 Alice 的凭证，创建一个文档并将其放入公共 RPKI 文档存储库。该文档说，“仅 Alice 的 Molly 的网络可以声称地址以 198.51.100 开头”，并用 Alice 的签名签名。该文档被放入 Bob 的路由器。后来，Alice 的路由器向 Bob 的路由器发送消息，说“我是地址以 198.51.100 开头的注册用户。将此类流量发给我！”但 Bob 的路由器响应，“不行，Alice。RPKI 说你不允许！”](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/03/28/Picture6-4.png)  

图 6: Molly 获得 Alice 的 RIR 凭证。  

常规的操作员错误可能导致类似结果。例如，如果 Alice 在创建文档时输入错误，她可能授权错误的网络接收针对她 IP 块的流量。Alice 还可能为她拥有的 IP 块创建授权，但这些授权并不精确匹配她的公告。所有这些错误都会导致合法声明被拒绝，尽管网络参与 RPKI 并按预期消费和处理这些文档。  

作为全球最具连接性的网络之一，AWS 看到了 RPKI 的巨大好处，但也认为需要采用“信任但验证”的方法。当这些类型的事件过去发生时，AWS 用户仍然可以与受影响网络交换流量，因为 AWS 继续遵循受影响网络的真实意图。那么，我们是如何做到的？  

## AWS 实施 RPKI 的审慎方法  

AWS 对 RPKI 的实施采用审慎方法。正如其他 RPKI 实施方式一样，我们首先从公共 RPKI 文档存储库下载所有网络的文档。然后，我们检查所有签名，以确定谁被授权接收针对所有文档化 IP 块的目的流量。完成此操作后，我们将这些授权发送到我们网络中的设备，这些设备决定接受或拒绝其他网络的公告。但这还不是全部。正如我们前面所述，RPKI 是一个强大的工具，可能对互联网连接造成重大影响。在构建 RPKI 部署管道时，我们预见了这些意外后果，并向我们的实施中添加了安全检查。  

![AWS 的网络经过四个步骤的过程。首先，它从公共 RPKI 文档存储库获取所有文档。其次，它检查文档的签名。第三，它执行安全检查。第四，它将文档发送到 AWS 的路由器。](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/03/28/Picture7-2.png)  

图 7: AWS 的网络经过四个步骤的过程。首先，它从公共 RPKI 文档存储库获取所有文档。其次，它检查文档的签名。第三，它执行安全检查。第四，它将文档发送到 AWS 的路由器。  

以下是我们纳入 RPKI 实施方式中的一些最具影响力的安全检查列表：  

  1. 我们预测推出新文档时可能发生的意外影响，例如导致网络后的大部分 IP 块无法访问。  
  2. 我们分批次向路由器发送变更。在批次之间暂停，同时观察各种健康指标，如果发现问题则回滚。  
  3. 我们保护我们自己的授权的创建和发布，以确保从更广泛互联网进入的用户能够保持连接。我们为此管道设置了大量防护措施。我们总是在发布文档前双重检查它是否与我们在互联网上做的任何活跃声明冲突。我们定期检查 RPKI 消费者软件是否精确反映我们的预期授权。我们验证刷新授权的工作流程是否正常运行，通过检查授权的到期时间。这些只是几个示例。我们在这一领域投入了大量资源，并将继续这样做。  
  4. 我们还在系统中构建了冗余，以处理我们的文档如何被其他网络消费。宣布大型重叠 IP 地址块并为每个块生成文档，会创建多层冗余，这些冗余必须全部失败才会产生影响。  

## 保护用户的面向互联网的工作负载  

自 2019 年首次采用 RPKI 以来，RPKI 一直是 AWS 保护用户面向互联网工作负载努力的核心。此外，随着其使用量的增长，它的重要性只会增加。在 2024 年，首次超过 50% 的互联网由 RPKI ROA (文档) 覆盖，这是所有互联网参与者的一个激动人心的里程碑。根据[美国国家标准与技术研究所](https://www.nist.gov/) (NIST) 的数据，截至 2025 年 5 月，这一指标已超过 55.8%，从 2024 年 5 月的 50.1% 上涨。我们期待这一趋势在 2025 年及以后继续，随着越来越多的互联网流量由 RPKI 保护。  

## 展望未来  

展望未来，我们也对加强 RPKI 实施方式感到兴奋，例如通过[自治系统提供者授权](https://www.ietf.org/archive/id/draft-ietf-sidrops-aspa-profile-17.html) (ASPA) 的标准化和实施。ASPA 将通过限制哪些网络可以声称一个 IP 块以及哪些网络可以传播它，来提供路径保护级别。这将有助于防止流量通过可能不可靠或不可信的网络。  

尽管 ASPA 仍在标准化中，我们致力于使用它以及我们掌握的所有工具，继续让互联网成为每个人安全可靠的地方。AWS 对 RPKI 的实施只是众多功能和服务中的一个示例，这些功能和服务（内部和外部）展示了我们如何优先考虑用户的安全。  

## 结语  

本文解释了 BGP 协议和 RPKI 的基础知识。我们展示了我们独特的 RPKI 实施方法及其为用户带来的好处。如果您对本文有疑问，请在[AWS re:Post](https://repost.aws/) 上启动一个新线程，或联系[AWS Support](https://aws.amazon.com/contact-us/)。  

* * *  

**References:**  

  1. 通过边界网关协议 (BGP) 前缀验证的数量衡量 ([NIST](https://www.nist.gov/))  

## 关于作者  

![Jonathan Phillibert](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/05/02/Jon-phonetool-square-125-1.jpg)  

### Jonathan Phillibert  

Jonathan 是 AWS 的首席网络开发工程师。  

![Camden Forgia](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2024/12/11/profile-photo-new.jpg)  

### Camden Forgia  

Camden 是 AWS 网络服务的首席产品经理。

<!-- AI_TASK_END: AI全文翻译 -->

