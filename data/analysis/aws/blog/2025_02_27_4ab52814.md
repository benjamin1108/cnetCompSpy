
<!-- AI_TASK_START: AI标题翻译 -->
[解决方案] 使用 Amazon Q 在 Amazon QuickSight 中可视化并洞察您的 VPC

<!-- AI_TASK_END: AI标题翻译 -->


<!-- AI_TASK_START: AI竞争分析 -->
# 产品功能分析

## 新功能/新产品概述  
Amazon Q in Amazon QuickSight 是 AWS 于 2024 年 4 月 30 日发布的增强功能，旨在通过 **生成式人工智能 (AI)** 简化数据可视化，支持用户使用自然语言查询生成交互式仪表板。该功能的核心目标是为 **Amazon QuickSight** 用户提供从各种数据源（如 VPC Flow Logs）提取洞察的能力，适用于技术水平不同的用户。背景在于，AWS 服务生成的大量日志和指标数据（如 VPC 连接模式）需要高效可视化，适用于 **业务智能 (BI)** 场景和网络流量分析。目标用户群包括企业 IT 管理员、网络工程师和业务分析师，市场定位聚焦于提升数据驱动决策的易用性和可访问性。

## 关键客户价值  
- **简化数据访问和分析**：通过自然语言查询（如“哪些成本标签在 2024 年 10 月消耗最多兆字节”），用户无需编写复杂 SQL，即可生成可视化仪表板，显著降低学习曲线，适用于非技术人员；相比传统 BI 工具（如 Tableau），这提供差异化优势，通过 **Amazon Q** 的直观交互提升效率，但可能受限于查询语义准确性。  
- **提升业务决策效率**：在 VPC 流量分析场景中，用户可快速识别流量模式和异常，实现 _成本优化和安全监控_，例如通过 enriched logs 量化网络使用；与竞品（如 Google Cloud's Looker）相比，QuickSight 的 AI 增强减少了手动配置需求，实现 _响应时间缩短_，但在高并发查询时可能面临延迟问题。  
- **扩展适用场景**：支持突发流量和日常监控，如结合 **Amazon Athena** 和 **S3** 处理日志，适用于混合云环境；相比传统 IaaS 架构，该功能通过 AI 驱动的动态可视化增强了灵活性，但在数据隐私合规（如 GDPR）场景中需注意权限管理。

## 关键技术洞察  
- **技术独特性**：基于 **EventBridge** 和自然语言处理算法，Amazon Q 实现事件驱动架构，支持毫秒级查询响应；其工作原理包括 Q topics 定义数据字段同义词（如将 IP 协议数字映射为“icmp”），从而将用户查询转换为 SQL 查询，并自动选择可视化类型（如柱状图）。  
- **创新点与影响**：创新在于集成 **AWS Lambda** 和 **Athena** 进行数据丰富和查询优化，提升了性能和可用性，例如在 Use Case #1 中，通过 Lambda 添加安全组标签，实现 _数据准确性提升_；然而，这也带来挑战，如冷启动延迟和数据索引刷新需求，可能影响大规模部署的安全性。相比传统 BI 工具，该功能通过 AI 模型（如基于 LLMs）显著提高了资源利用率，但潜在局限性包括查询歧义导致的错误可视化，以及对 **QuickSight Enterprise Edition** 的依赖，可能增加成本。  
- **挑战与解决方式**：技术实现面临数据源异构性问题，AWS 通过 **Glue Catalog** 标准化日志格式来解决；此外，安全性方面依赖 **CloudWatch** 监控，但在大规模组网时，管理复杂度上升，建议用户自定义 Q topics 以优化准确性。

## 其他信息  
该产品支持通过 AWS CloudFormation 模板快速部署，GitHub 仓库提供示例和演练指南，鼓励用户探索更多用例以适应行业趋势，如 AI 驱动的网络分析。

<!-- AI_TASK_END: AI竞争分析 -->


<!-- AI_TASK_START: AI全文翻译 -->
# 使用 Amazon Q 在 Amazon QuickSight 中可视化和洞察您的 VPC

**原始链接:** [https://aws.amazon.com/blogs/networking-and-content-delivery/visualize-and-gain-insights-into-your-vpc-with-amazon-q-in-amazon-quicksight/](https://aws.amazon.com/blogs/networking-and-content-delivery/visualize-and-gain-insights-into-your-vpc-with-amazon-q-in-amazon-quicksight/)  

**发布时间:** 2025-02-27  

**厂商:** AWS  

**类型:** BLOG  

---  
## 引言  

AWS 服务生成丰富的日志和指标数据，让您能够创建全面的仪表板，从而揭示宝贵洞察，包括对虚拟私有云 (VPC) 连接模式的详细可见性。本文展示如何使用 [Amazon QuickSight](https://aws.amazon.com/quicksight/) 和 [Amazon Q in QuickSight](https://aws.amazon.com/about-aws/whats-new/2024/04/amazon-q-quicksight/) 从任何来源实现数据可视化。我们重点关注 VPC 中的连接模式可视化，以展示 QuickSight 对技术水平不同的用户的益处。  

Amazon QuickSight 是一个完全托管的、云规模商业智能 (BI) 服务，允许用户创建和共享交互式仪表板、分析数据，并通过可视化获得洞察。2024 年 4 月 30 日，AWS 宣布 Amazon Q in QuickSight 正式可用，这通过提供生成式人工智能 (AI) 功能来增强 QuickSight，使用自然语言查询实现数据可视化。  

在以下部分，我们探讨两个用例，这些用例从不同来源收集数据、增强数据，并使用 QuickSight 进行可视化。这些示例展示 [Amazon Q](https://aws.amazon.com/q/) 如何快速从常见自然语言查询生成可视化，突出使用 QuickSight 和 Q 生成洞察仪表板的简便性和效率。  

## 概述  

本文呈现两个用例，展示如何使用 Amazon Q in QuickSight 可视化 VPC 流量日志 (VPC Flow Logs) 数据。这些示例独立于用于捕获和增强数据的来源解决方案。尽管我们为本文开发了这些用例，但您也可以将其作为参考，应用于任何其他用例。  

### 用例 #1: 带安全组和成本标签的增强 VPC 流量日志  

![图 1 - 架构图 – 使用 Amazon Q in QuickSight 增强的 VPC 流量日志](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/18/vpc-flowlogs-architecture.png)  

*图 1: 架构图 – 使用 Amazon Q in QuickSight 增强的 VPC 流量日志*  

VPC 流量日志使用预定义 [fields](https://docs.aws.amazon.com/vpc/latest/userguide/flow-log-records.html) 生成记录。 [AWS Lambda](https://aws.amazon.com/lambda/) 可以增强这些流量日志，添加更多字段，从而创建 VPC 流量流的自定义视图。  

如图 1 所示的架构中，VPC 流量日志生成并发送到 [Amazon Data Firehose](https://aws.amazon.com/firehose/)。日志随后转发到 Lambda 进行增强。Lambda 为流量日志添加更多属性，例如 VPC 流量日志条目中 [Amazon Elastic Compute Cloud (Amazon EC2)](https://aws.amazon.com/ec2/) 实例的安全组和成本标签，然后将它们交付到 [Amazon S3](https://aws.amazon.com/s3/)。 [AWS Glue](https://aws.amazon.com/glue/) 目录存储增强的 VPC 流量日志的表定义。这允许 [Amazon Athena](https://aws.amazon.com/athena/) 高效查询数据。最后，QuickSight 从 Athena 可视化数据。数据流如下：  

  1. 通过 [AWS CloudFormation](https://aws.amazon.com/cloudformation/) 模板在现有 VPC 上启用 VPC 流量日志。  
  2. 日志记录发送到 Data Firehose。  
  3. Data Firehose 配置为将指标和日志发送到 [Amazon CloudWatch](https://aws.amazon.com/cloudwatch/) 以供故障排除。  
  4. Data Firehose 调用 Lambda 以增强 VPC 流量日志，添加更多属性，例如 Amazon EC2 安全组和成本标签。  
  5. Lambda 配置为将指标和日志发送到 CloudWatch 以供故障排除。  
  6. 增强的 VPC 流量日志交付到一个 S3 存储桶。  
  7. AWS Glue 爬取 S3 存储桶，以目录化数据以供查询。  
  8. Athena 查询来自 AWS Glue 的目录化数据。  
  9. QuickSight 使用 Athena 和 Amazon S3 作为数据集的数据源。创建一个空白分析，准备开始可视化 VPC 流量日志。  
  10. 通过 Q 主题在分析中启用 Amazon Q。Q 主题允许 QuickSight 解释自然语言查询，以促进分析中视觉开发。  

### 用例 #2: VPC 流量日志和 Amazon Route 53 Resolver 日志  

![图 2 - 架构图 – 使用 Amazon Q in QuickSight 增强的 VPC 流量分析与 Route 53 Resolver 日志](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/18/vpcflowlogswithdnsarchitecture.png)  

*图 2: 架构图 – 使用 Amazon Q in QuickSight 增强的 VPC 流量分析与 Route 53 Resolver 日志*  

VPC 流量日志和 [Amazon Route 53 Resolver](https://aws.amazon.com/route53/) 日志提供关于 VPC 中网络流量的互补信息。  

如图 2 所示的架构中，VPC 流量日志捕获 VPC 中不同 IP 地址之间流量的详细信息，但不包括域名。此组合提供 VPC 网络流量的全面视图。数据流如下：  

  1. 通过 CloudFormation 模板在现有 VPC 上启用 VPC 流量日志。  
  2. VPC 流量日志发送到 Amazon S3。  
  3. Route 53 Resolver 日志也创建并与启用 VPC 流量日志的 VPC 相关联。  
  4. Route 53 Resolver 日志发送到 Amazon S3。  
  5. Lambda 用于执行 Athena 查询，以合并 VPC 流量日志和 Route 53 Resolver 日志。  
  6. 每天基于 IP 地址合并 VPC 流量日志和 Route 53 Resolver 日志。这些映射将 VPC 流量日志中的网络流量映射到域名，并每天更新分析。域名到 IP 映射的更改会相应更新。  
  7. QuickSight 使用 Athena 和 Amazon S3 作为数据集的数据源。创建一个空白分析，准备开始可视化 VPC 流量日志。  
  8. 通过 Q 主题在分析中启用 Amazon Q。Q 主题允许 QuickSight 解释自然语言查询，以促进分析中视觉开发。  

本文为第一个用例提供演练。对于两个用例的更多详细信息，例如演练和相关 CloudFormation 模板，请访问 AWS Samples GitHub [repository](https://github.com/aws-samples/visualize-and-gain-Insights-into-your-VPC-with-Amazon-Q-in-Amazon-QuickSight)。  

## 先决条件  

在开始之前，请执行以下步骤：  

  1. 部署 aws-samples GitHub [repository](https://github.com/aws-samples/visualize-and-gain-Insights-into-your-VPC-with-Amazon-Q-in-Amazon-QuickSight) 中提供的其中一个 CloudFormation 模板。该存储库中的每个示例都有自己的详细文档，托管在 [aws-samples](https://github.com/aws-samples) GitHub 存储库中。  
  2. 确保您的 QuickSight 用户拥有 [PRO 角色，以访问本文中展示的 Amazon Q 功能](https://repost.aws/articles/ARLexnrP0DSLKU7ZBPB6jTgQ/how-to-update-my-user-in-amazon-quicksight-to-admin-pro)。  

本文提供两个示例。我们可能会在未来向 aws-samples 存储库添加更多示例。本文中的演练步骤适用于所有提供的示例。  

## 演练: 使用 Q in QuickSight 洞察数据  

  1. 查看部署的 CloudFormation 模板中预配置的 Q 主题。Q 主题通过建立自然语言同义词与数据字段来简化可视化查询。  
  2. 在 QuickSight 中查询 Q，以洞察您的 VPC 流量日志数据。  

### 1\. 在 QuickSight 中查看 Q 主题  

在本部分，我们查看 CloudFormation 模板部署的 Q 主题。  

按照图 3 所示的步骤操作。  

  1. 打开 [AWS Console](https://us-east-1.console.aws.amazon.com/console/home) 并导航到 [QuickSight](https://us-east-1.quicksight.aws.amazon.com/)。  
  2. 在左侧窗格中，选择 [**Topics**](https://docs.aws.amazon.com/quicksight/latest/user/quicksight-q-topics.html)。  
  3. 选择主题名称。  

![图 3 - Q 主题](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/19/QTopics-1.png)  

*图 3: Q 主题*  

选择顶部的选项卡，导航到 **Data**，然后 **DATA FIELDS**。QuickSight 会自动用数据集中的字段填充数据字段。它还会在可能的情况下为相应字段填充同义词。在此示例中，同义词已在 CloudFormation 模板中定义。同义词有助于 Amazon Q 将您的查询与数据集中的字段相关联。您可以进一步 [customize](https://docs.aws.amazon.com/quicksight/latest/user/quicksight-q-topics-natural-language.html) 数据字段，以匹配您组织的术语。这将导致 Amazon Q 提供更具意义和准确的响应。 [Refresh the Q topic indexes](https://docs.aws.amazon.com/quicksight/latest/user/quicksight-q-topics-index.html) 以在未来分析中反映这些更改。  

![图 4 - Q 主题 – 编辑主题](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/18/EditTopics.png)  

*图 4: Q 主题 – 编辑主题*  

另一个有帮助的自定义是 **Field Value Synonyms**。这允许您为 VPC 流量日志数据中的值添加同义词。在以下示例中，已为 IP 协议号码添加了同义词。这使 Q 能够正确解释使用 **icmp**、**tcp**、**udp** 等词的 VPC 流量日志查询。  

![图 5 - Q 主题 – 编辑同义词](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/18/EditSynonyms.png)  

*图 5: Q 主题 – 编辑同义词*  

### 2\. 查询 Q 以洞察 VPC 流量日志数据  

我们向 QuickSight 中的 Q 提出关于 VPC 流量日志数据的问题。在 **QuickSight** 屏幕的顶部中心，选择 **Ask a question about**。  

![图 6 - Q 主题 – 提出问题](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/18/AskAQuestion.png)  

*图 6: Q 主题 – 提出问题*  

如图 7 所示，我们向 Amazon Q 提出了“which cost tags had the most megabytes in October 2024 by hour”的问题。Amazon Q 处理了我们的问题，并使用定义的同义词，将其解释为“Total Megabytes by Start Datetime hour and Cost Tag for Start Datetime in October 2024”。Amazon Q 针对问题提供了响应，并附带详细的可视化数据支持该响应。  

![图 7 - Q 主题 – 问题结果](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/18/QuestionResults.png)  

*图 7: Q 主题 – 问题结果*  

## 演练: 使用 Amazon Q 填充 QuickSight 分析  

  1. 将 Q 主题链接到 QuickSight 分析。  
  2. 通过添加由 Amazon Q 生成的可视化来填充 QuickSight 分析。本文提供了一些示例查询。  

### 1\. 将 QuickSight 分析链接到 Q 主题  

查看 Q 主题后，我们探索分析。分析是可视化、交互式仪表板和数据洞察的集合，这些元素创建并组织在一个或多个工作表中，以有效探索和呈现数据。  

我们在分析中创建我们的第一个可视化。CloudFormation 模板已创建一个链接到从 Athena 导入 VPC 流量日志数据的空白分析。选择分析名称开始，如图 8 所示。  

![图 8 - Amazon Q 分析](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/18/QAnalyses.png)  

*图 8: Amazon Q 分析*  

要运行 Amazon Q 查询，请将 Q 主题链接到分析。在顶部栏的中心，选择 **Build visual** 旁边的垂直省略号 (**⋮**)，然后从菜单中选择 **Topic Linking**。启用 **Link topic for Build Visual and Q &A option**，并从下拉菜单中选择由 CloudFormation 部署的主题。选择 **APPLY CHANGES**，如图 9 所示。  

![图 9 - Amazon Q 分析 – 主题链接](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/18/TopicLinking.png)  

*图 9: Amazon Q 分析 – 主题链接*  

### 2\. 填充 QuickSight 分析  

在顶部栏的中心，选择 **Build visual**。**Build a visual** 右窗格会显示。开始键入第一个自然语言 [question](https://docs.aws.amazon.com/quicksight/latest/user/quicksight-q-ask.html#quicksight-q-ask-types)，然后选择 **BUILD**。对于第一个用例，我们提供了四个示例问题来帮助您入门。QuickSight 文档提供了 [Q 支持的问题类型](https://docs.aws.amazon.com/quicksight/latest/user/quicksight-q-ask.html#quicksight-q-ask-types) 以及更多示例问题。 [QuickSight Enterprise Edition](https://aws.amazon.com/blogs/business-intelligence/amazon-q-in-quicksight-brings-new-user-roles-and-pricing-to-amazon-quicksight-enterprise-edition/) 是使用 Amazon Q 提出问题的先决条件。  

示例问题：  

  * show top source and destination ip by gigabyte  
  * show top source ip and path internet gateway by gigabyte  
  * show top security group by megabytes  
  * show megabytes egress date start May by hour  

第二个用例有其自己的示例问题，记录在 GitHub [repository](https://github.com/aws-samples/visualize-and-gain-Insights-into-your-VPC-with-Amazon-Q-in-Amazon-QuickSight) 中。  

Amazon Q 会解释问题，并基于数据集中的字段和链接主题中定义的同义词派生查询。Amazon Q 还会选择可视化类型，您可以更改它。在可视化的右上角，选择条形图图像，然后选择最适合表示数据的可视化类型。选择 **ADD TO ANALYSIS**，如图 10 所示。  

![图 10 - Amazon Q 分析 – 构建可视化](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/19/BuildVisual.png)  

*图 10: Amazon Q 分析 – 构建可视化*  

以下仪表板已用四个示例问题的可视化填充，如图 11 所示。  

![图 11 - Amazon Q 分析 – 部署的可视化](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/19/DeployedVisuals-1.png)  

*图 11: Amazon Q 分析 – 部署的可视化*  

## 结论  

本文中，您学习了如何使用 Amazon QuickSight 通过自然语言查询从各种数据来源可视化数据。Amazon Q in QuickSight 实现了数据访问的民主化，让组织中的每个人都能做出基于数据的决策。通过将数据组织成直观的主题并启用自然语言查询，Amazon Q 用户可以获得对 VPC 流量的洞察。为了帮助您的团队开始使用 QuickSight，我们建议观看以下教程 [What is Amazon QuickSight Q](https://youtu.be/YYB544JH1LY) 和 [Best practices for QuickSight Q Authors](https://youtu.be/ud_WdXf_-l0)。  

## 作者  

![作者 - Rashmiman Ray](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/18/Ray-1.jpg)  

### Rashmiman Ray  

Rashmiman 是 AWS 的技术账户经理，位于新泽西州。他与 AWS 企业客户合作，提供技术指导和最佳实践建议，帮助他们在云中取得成功。工作之外，他喜欢在步道上远足、打板球和烹饪印度美食。  

![Opeoluwa Victor Babasanmi](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/18/Victor-1.jpg)  

### Opeoluwa Victor Babasanmi  

Victor 是 AWS 的资深网络专业解决方案架构师。他专注于为客户提供技术指导，帮助他们使用最佳实践规划和构建解决方案，并主动保持其 AWS 环境的操作健康。当他不在帮助客户时，您可能会发现他在踢足球、健身或寻找新冒险。  

![作者 - Diego Hernandez](https://d2908q01vomqb2.cloudfront.net/5b384ce32d8cdef02bc3a139d4cac0a22bb029e8/2025/02/18/Diego-1.jpg)  

### Diego Hernandez  

Diego Hernandez 是位于加拿大的技术账户经理。Diego 对所有网络相关事物的热情。在业余时间，Diego 喜欢与家人共度时光和滑雪。

<!-- AI_TASK_END: AI全文翻译 -->

